<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voronoi Map Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <aside class="sidebar">
            <header class="logo">
                <h1>Voronoi<span>Gen</span></h1>
                <p>Fantasy Map Cells</p>
            </header>

            <section class="panel">
                <h2>Generation</h2>
                <div class="field">
                    <label for="cell-count">Cell Count</label>
                    <div class="input-group">
                        <input type="number" id="cell-count" value="50000" min="100" max="100000" step="1000">
                        <span class="unit">cells</span>
                    </div>
                </div>
                <div class="field">
                    <label for="distribution">Distribution</label>
                    <select id="distribution">
                        <option value="random">Random</option>
                        <option value="jittered" selected>Jittered Grid</option>
                        <option value="poisson">Poisson Disk</option>
                        <option value="relaxed">Pre-relaxed</option>
                    </select>
                </div>
                <div class="field">
                    <label for="seed">Seed</label>
                    <div class="input-group">
                        <input type="number" id="seed" value="12345" min="1">
                        <button class="btn-icon" id="random-seed" title="Random seed">⟳</button>
                    </div>
                </div>
                <button class="btn primary" id="generate-btn">Generate</button>
            </section>

            <section class="panel">
                <h2>Heightmap</h2>
                <div class="field">
                    <label for="noise-algorithm">Algorithm</label>
                    <select id="noise-algorithm">
                        <option value="continental" selected>Continental (Realistic)</option>
                        <option value="eroded">Eroded (Valleys)</option>
                        <option value="multiwarp">Multi-Warp (Very Organic)</option>
                        <option value="swiss">Swiss (Rolling Hills)</option>
                        <option value="valleys">Valleys (River-like)</option>
                        <option value="terraced">Terraced (Plateaus)</option>
                        <option value="ridged">Ridged (Mountains)</option>
                        <option value="warped">Warped (Organic)</option>
                        <option value="fbm">FBM (Classic)</option>
                        <option value="simplex">Simplex (Simple)</option>
                    </select>
                </div>
                <div class="field">
                    <label for="noise-frequency">Frequency</label>
                    <input type="range" id="noise-frequency" min="0.5" max="8" step="0.1" value="3">
                    <span class="range-value" id="noise-frequency-value">3.0</span>
                </div>
                <div class="field">
                    <label for="noise-octaves">Octaves (Detail)</label>
                    <input type="range" id="noise-octaves" min="1" max="8" step="1" value="6">
                    <span class="range-value" id="noise-octaves-value">6</span>
                </div>
                <div class="field">
                    <label for="sea-level">Sea Level</label>
                    <input type="range" id="sea-level" min="0" max="0.8" step="0.01" value="0.4">
                    <span class="range-value" id="sea-level-value">0.40</span>
                </div>
                <div class="field">
                    <label for="falloff-type">Edge Falloff</label>
                    <select id="falloff-type">
                        <option value="none">None</option>
                        <option value="radial" selected>Radial (Island)</option>
                        <option value="square">Square</option>
                    </select>
                </div>
                <div class="field">
                    <label for="falloff-strength">Falloff Strength</label>
                    <input type="range" id="falloff-strength" min="0" max="1" step="0.05" value="0.7">
                    <span class="range-value" id="falloff-strength-value">0.70</span>
                </div>
                <div class="field">
                    <label for="smoothing">Smoothing Passes</label>
                    <input type="range" id="smoothing" min="0" max="10" step="1" value="0">
                    <span class="range-value" id="smoothing-value">0</span>
                </div>
                <div class="field">
                    <label for="smoothing-strength">Smoothing Strength</label>
                    <input type="range" id="smoothing-strength" min="0" max="1" step="0.05" value="0.6">
                    <span class="range-value" id="smoothing-strength-value">0.60</span>
                </div>
                <button class="btn primary" id="generate-heightmap-btn">Generate Heightmap</button>
            </section>

            <section class="panel">
                <h2>Climate</h2>
                <div class="field">
                    <label for="wind-direction">Wind Direction</label>
                    <select id="wind-direction">
                        <option value="0">North (↓)</option>
                        <option value="45">Northeast (↙)</option>
                        <option value="90">East (←)</option>
                        <option value="135">Southeast (↖)</option>
                        <option value="180">South (↑)</option>
                        <option value="225">Southwest (↗)</option>
                        <option value="270" selected>West (→)</option>
                        <option value="315">Northwest (↘)</option>
                    </select>
                </div>
                <div class="field">
                    <label for="wind-strength">Wind Strength</label>
                    <input type="range" id="wind-strength" min="0.1" max="1" step="0.1" value="0.8">
                    <span class="range-value" id="wind-strength-value">0.80</span>
                </div>
                <div class="field inline">
                    <input type="checkbox" id="show-rivers" checked>
                    <label for="show-rivers">Show Rivers</label>
                </div>
                <div class="field inline">
                    <input type="checkbox" id="show-river-sources">
                    <label for="show-river-sources">Show River Sources</label>
                </div>
                <div class="field">
                    <label for="num-rivers">Number of Rivers</label>
                    <input type="range" id="num-rivers" min="5" max="100" step="5" value="30">
                    <span class="range-value" id="num-rivers-value">30</span>
                </div>
                <button class="btn primary" id="generate-precip-btn">Generate Precipitation</button>
                <button class="btn" id="generate-rivers-btn">Generate Rivers</button>
            </section>

            <section class="panel">
                <h2>Political</h2>
                <div class="field">
                    <label for="num-kingdoms">Number of Kingdoms</label>
                    <input type="range" id="num-kingdoms" min="3" max="30" step="1" value="12">
                    <span class="range-value" id="num-kingdoms-value">12</span>
                </div>
                <button class="btn primary" id="generate-kingdoms-btn">Generate Kingdoms</button>
            </section>

            <section class="panel">
                <h2>Display</h2>
                <div class="field">
                    <label for="render-mode">Render Mode</label>
                    <select id="render-mode">
                        <option value="political" selected>Political Map</option>
                        <option value="terrain">Land/Water</option>
                        <option value="rivers">Flow Arrows</option>
                        <option value="heightmap">Grayscale Heightmap</option>
                        <option value="precipitation">Precipitation</option>
                        <option value="cells">Cells Only</option>
                    </select>
                </div>
                <div class="field">
                    <label for="subdivision">Contour Smoothing</label>
                    <input type="range" id="subdivision" min="0" max="4" step="1" value="2">
                    <span class="range-value" id="subdivision-value">2</span>
                </div>
                <div class="toggle-group">
                    <label class="toggle">
                        <input type="checkbox" id="show-edges" checked>
                        <span>Cell Edges</span>
                    </label>
                    <label class="toggle">
                        <input type="checkbox" id="show-centers">
                        <span>Cell Centers</span>
                    </label>
                    <label class="toggle">
                        <input type="checkbox" id="show-delaunay">
                        <span>Delaunay Mesh</span>
                    </label>
                </div>
            </section>

            <section class="panel">
                <h2>Viewport</h2>
                <div class="field">
                    <label>Zoom Level</label>
                    <div class="zoom-controls">
                        <button class="btn-icon" id="zoom-out" title="Zoom Out">−</button>
                        <span class="zoom-level" id="zoom-level">100%</span>
                        <button class="btn-icon" id="zoom-in" title="Zoom In">+</button>
                        <button class="btn-icon" id="zoom-reset" title="Reset View">⟲</button>
                    </div>
                </div>
                <div class="field">
                    <label>Suggested Cells</label>
                    <span class="suggested-cells" id="suggested-cells">50,000</span>
                </div>
                <button class="btn primary" id="redraw-btn" title="Regenerate cells at higher density for current view">
                    Redraw at Resolution
                </button>
                <div class="field">
                    <span class="hint">Scroll to zoom • Drag to pan • R to redraw</span>
                </div>
            </section>

            <section class="panel">
                <h2>Export</h2>
                <div class="btn-row">
                    <button class="btn" id="export-json">JSON Data</button>
                    <button class="btn" id="export-png">PNG Image</button>
                </div>
            </section>

            <section class="panel stats">
                <h2>Statistics</h2>
                <dl>
                    <dt>Cells</dt>
                    <dd id="stat-cells">0</dd>
                    <dt>Visible</dt>
                    <dd id="stat-visible">0</dd>
                    <dt>Land</dt>
                    <dd id="stat-land">0%</dd>
                    <dt>Generation</dt>
                    <dd id="stat-gen-time">0ms</dd>
                    <dt>Render</dt>
                    <dd id="stat-render-time">0ms</dd>
                </dl>
            </section>
        </aside>

        <main class="canvas-area">
            <canvas id="voronoi-canvas"></canvas>
            <div id="cell-tooltip" class="cell-tooltip"></div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/d3-delaunay@6"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-contour@4"></script>
    <script type="module" src="app.js?v=156"></script>
</body>
</html>
